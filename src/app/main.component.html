@if ((isAuthenticated$ | async)?.isAuthenticated) {
<div class="app-layout"
     [class.sidebar-collapsed]="isSidebarCollapsed"
     [class.mobile-menu-open]="isMobileMenuOpen"
     [class.dashboard-view]="currentRoute === 'dashboard'">

  <!-- Mobile Overlay -->
  @if (isMobileMenuOpen) {
    <div class="mobile-overlay" (click)="closeMobileMenu()"></div>
  }

  <app-sidebar
    [class.mobile-open]="isMobileMenuOpen"
    (collapsedChange)="onSidebarCollapsedChange($event)"
    (logout)="logout()"
    (mobileMenuClose)="closeMobileMenu()">
  </app-sidebar>

  <app-header
    [hasSelection]="hasSelectedItems" [userData]="(userData$ | async)"
    (mobileMenuToggle)="toggleMobileMenu()">
  </app-header>

  @if(currentRoute == 'my-folder') {
  <app-breadcrumb [breadcrumbs]="breadcrumbs" (navigate)="onNavigate($event)">
  </app-breadcrumb>
  }

  <div class="main-content"
    [class.dashboard-content]="currentRoute !== 'my-folder'"
    [class.file-explorer-view]="currentRoute === 'my-folder' || currentRoute === 'recycle-bin' || currentRoute === 'search' || currentRoute === 'favorites'"
    [class.center-content]="isWipRoute">
    <router-outlet></router-outlet>
  </div>

  @if (isDownloading) {
  <app-download-progress></app-download-progress>
  }
</div>
} @else {
<div class="loading-page">
  <mat-progress-bar mode="indeterminate"></mat-progress-bar>
</div>
}