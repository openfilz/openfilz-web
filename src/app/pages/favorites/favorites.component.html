<div class="favorites-container">
  <!-- Toolbar with integrated pagination (no upload/create folder buttons) -->
  <app-toolbar [viewMode]="viewMode" [hasSelection]="hasSelectedItems" [selectionCount]="selectedItems.length"
    [pageIndex]="pageIndex" [pageSize]="pageSize" [totalItems]="totalItems" [showUploadButton]="false"
    [showCreateFolderButton]="false" (viewModeChange)="onViewModeChange($event)" (renameSelected)="onRenameSelected()"
    (downloadSelected)="onDownloadSelected()" (moveSelected)="onMoveSelected()" (copySelected)="onCopySelected()"
    (deleteSelected)="onDeleteSelected()" (clearSelection)="onClearSelection()" (previousPage)="onPreviousPage()"
    (nextPage)="onNextPage()" (pageSizeChange)="onPageSizeChange($event)" [sortBy]="sortBy" [sortOrder]="sortOrder"
    (sortChange)="onSortChange($event)">

    <!-- Breadcrumb projected into toolbar for mobile visibility -->
    <div toolbarBreadcrumb class="toolbar-breadcrumb-compact">
      <button mat-icon-button [attr.aria-label]="'favorites.title' | translate" class="breadcrumb-home-btn">
        <mat-icon>favorite</mat-icon>
      </button>
      <span class="breadcrumb-text">{{ 'favorites.title' | translate }}</span>
    </div>
  </app-toolbar>

  <div class="favorites-content">
    @if (loading) {
    <div class="loading-container">
      <mat-spinner></mat-spinner>
      <p>{{ 'favorites.loading' | translate }}</p>
    </div>
    }

    @if (!loading && items.length === 0) {
    <div class="empty-state">
      <mat-icon class="empty-icon">favorite_border</mat-icon>
      <h2>{{ 'favorites.emptyTitle' | translate }}</h2>
      <p>{{ 'favorites.emptyMessage' | translate }}</p>
    </div>
    }

    @if (!loading && items.length > 0) {
    @if (viewMode === 'grid') {
    <app-file-grid [items]="items" (itemClick)="onItemClick($event)" (itemDoubleClick)="onItemDoubleClick($event)"
      (selectionChange)="onSelectionChange($event)" (toggleFavorite)="onToggleFavorite($event)"
      (rename)="onRenameItem($event)" (download)="onDownloadItem($event)" (move)="onMoveItem($event)"
      (copy)="onCopyItem($event)" (delete)="onDeleteItem($event)" (viewProperties)="onViewProperties($event)">
    </app-file-grid>
    }

    @if (viewMode === 'list') {
    <app-file-list [items]="items" (itemClick)="onItemClick($event)" (itemDoubleClick)="onItemDoubleClick($event)"
      (selectionChange)="onSelectionChange($event)" (selectAll)="onSelectAll($event)"
      (toggleFavorite)="onToggleFavorite($event)" (rename)="onRenameItem($event)" (download)="onDownloadItem($event)"
      (move)="onMoveItem($event)" (copy)="onCopyItem($event)" (delete)="onDeleteItem($event)"
      (viewProperties)="onViewProperties($event)" [sortBy]="sortBy" [sortOrder]="sortOrder"
      (sortChange)="onSortChange($event)">
    </app-file-list>
    }
    }
  </div>

  <!-- Metadata Panel -->
  <app-metadata-panel [documentId]="selectedDocumentForMetadata" [isOpen]="metadataPanelOpen"
    (closePanel)="closeMetadataPanel()" (metadataSaved)="onMetadataSaved()">
  </app-metadata-panel>
</div>